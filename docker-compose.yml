services:
  claude-box:
    image: ghcr.io/andresmorales07/claude-box:1
    container_name: claude-box
    ports:
      - "2222:2222"
      - "7681:7681"
    volumes:
      - claude-config:/home/claude/.claude
      - workspace:/home/claude/workspace
    environment:
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - CLAUDE_USER_PASSWORD=${CLAUDE_USER_PASSWORD:-changeme}
      - TTYD_USERNAME=${TTYD_USERNAME:-claude}
      - TTYD_PASSWORD=${TTYD_PASSWORD:-changeme}
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "curl -f -u \"${TTYD_USERNAME}:${TTYD_PASSWORD}\" http://localhost:7681"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s

volumes:
  claude-config:
  workspace:
